#!/usr/bin/env python
"""commit-msg: 커밋 메시지 간결성 검증."""

from __future__ import annotations

import re
import sys
from pathlib import Path


def main() -> None:
    if len(sys.argv) < 2:
        sys.stderr.write("[오류] 커밋 메시지 파일이 전달되지 않았습니다.\n")
        sys.exit(1)

    message_path = Path(sys.argv[1])
    message = message_path.read_text(encoding="utf-8")
    if not message.strip():
        sys.stderr.write("[오류] 커밋 메시지가 비어 있습니다.\n")
        sys.exit(1)

    title = message.splitlines()[0].strip()
    if len(title) > 50:
        sys.stderr.write(f"[오류] 커밋 제목이 50자를 초과했습니다 ({len(title)}자).\n")
        sys.exit(1)

    if len(title) < 2:
        sys.stderr.write("[경고] 커밋 제목이 지나치게 짧습니다.\n")

    if not re.search(r"[가-힣]", title):
        sys.stderr.write("[경고] 커밋 제목에 한글이 없습니다. 한글 사용을 권장합니다.\n")


if __name__ == "__main__":
    main()
